import 'dotenv/config';
import { PrismaClient } from '@prisma/client'
import { PrismaPg } from '@prisma/adapter-pg';
import { Pool } from 'pg';

const pool = new Pool({ 
  connectionString: process.env.DATABASE_URL,
  ssl: {
    rejectUnauthorized: false 
  }
});

const adapter = new PrismaPg(pool);
const prisma = new PrismaClient({ adapter });

// Your rules object...
const rawRules = {
  "MG": "الخلط بين الشات الواقعي و الغير واقعي",
"PG": "فعل اشياء خارقة",
"DM": "القتل دون سبب مقنع",
"PK": "فقدان الذاكرة بعد الموت",
"CK": "اعدام شخصية من ادمن",
"PH": "الجري و القفز في نفس الوقت",
"BH": "الجري و القفز في نفس الوقت",
"PD": "استفزاز الشرطة للمتعة",
"NON-RP": "فعل اشياء دون اربي",
"NONRP": "فعل اشياء دون اربي",
"SK": "قتل الرسبون",
"KOS": "الحقد على الاربي من داخله و خارجه",
"DDB": "القتل اثناء السياقة",
"RPZ": "منطقة العيش في السيرفر",
"NJ": "انزال شخص من مركبته",
"ATA": "نقل ممتلكات شخصية الى اخرى",
"RK": "قتل الانتقام",
"GR": "احترام الناس",
"RTR": "الجري بستمرار دون تعب",
"SL": "حياة مقززة",
"DRP": "حياة مقززة",
"NL": "حياة مقززة",
"CD": "تطوير الشخصية",
"MA": "تعدد الحسابات",
"RDM": "قتل نفس الشخص دون توقف",
"RPG": "اخذ اربيجي من امر السلاح ",
"SP": "سرقة غير واقعية",
"SC": "تستخدم اسم شخصية مشهورة",
"TK": "قتل شخص من الفاكشن",
"UH": "فعل العادات المضرة كالتدخين",
"DB": "قتل الاشخاص بسيارة",
"VDM": "قتل الاشخاص بسيارة",
"CDM": "قتل الاشخاص بسيارة",
"WH": "ققز فوق السيارات و البيوت بدراجة هوائية",
"BRAWLS": "القتل دون اربي",
"BR": "وجوب الفتل داخل الأربي فقط",
"CCTV": "لغة التهكير و البرمجة",
"CR": "الجري المتعرج لتفادي اطلاق النار",
"DP": "دعس شخص بالاربي",
"DUC": "تدميرحياة شخصية مثل الانتحار",
"DFL": "تدميرحياة شخصية مثل الانتحار",
"LK": "اذن اطلاق النار في مكان عام كمركز المدينة",
"LTA": "الهروب من الاربي",
"MA": "كل شخص له حساب واحد فقط",
"MC": "اطلاق النار بالغلط",
"NG": "تنزل شخص من مركبته الخاصة",
"NK": "الضرب اثناء الجري",
"DOS": "شارة دون ديوتي او ديوتي دون شارة",
"DDP": "اطلاق النار و القتل اثناء السياقة",
"SE": "تنظيم الاربي من قبل الاشراف و الادمن",
"WA": "اعلان خاطئ",
"WS": "ستايتس خاطئ",
"MD": "كلبشة دون سبب مقنع",
"ARSON": "قانون الحرائق تحت مراقة ادمن",
"BF": "تبديل الاسلحة دون اربي",
"AA": "استخدام الادمن رتبته لمصلحته",
"AE": "الكذب على ادمن",
"APG": "استخدام امتيازات ادمن بشكل غير واقعي",
"AC": "شخصية اخرى في نفس الفاكشن",
"CA": "تدمير حياة الشخصية",
"CR2": "قتل الشخص المسروق",
"CS": "استخدام قلتش بالاسلحة",
"CP": "قانون سرقت المحلات التجارية",
"CORRUPTION": "قانون الفساد المالي",
"PM": "قانون الرسائل الخاصة",
"PI": "قانون تفتيش الممتلكات و العقارات",
"RP": "قانون استخدام الاربي",
"RPAPK": "التصرف بواقعية بعد الموت",
"RA": "ارتكاب جرائم خطيرة امام مقرات عامة",
"DFA": "استخدام مخدرات دون اربي",
"FRP": "فشل لاعب في تقمص دوره",
"EXPLOITING": "استخدام جلتشات",
"GFA": "اخراج السلاح دون اربي",
"INACTIVITY": "عدم النشاط",
"LOWRP": "اربي ضعيف",
"LOW RP": "اربي ضعيف",
"LOHR": "الكذب على الادمن",
"LIRL": "محاولة ايقاف اربي دون سبب",
"NOT WIER": "استعمال اربي صحيح عند تشغيل للمحرك",
"NOTWIER": "استعمال اربي صحيح عند تشغيل للمحرك",
"NLR": "عدم محاولة الانتقام بعد الموت بسبب فقدان الذاكرة",
"SA": "نشر سيرفرات اخرى",
"S&EW": "قانون الهدنة و الحرب بين العصابات",
"VD": "قانون وصف السيارات",
"VR": "قانون سرقت السيارة دون تشغيل المحرك",
"VT": "قانون سرقت السيارة و تشغيل المحرك",
"QS": "تبديل الاسلحة في اليد دون اربي",
"IC": "الشات الواقعي داخل الاربي",
"OOC": "شات خارج الاربي",
"GATE": "امر فتح الباب",
"DUTY": "امر فتح الديوتي",
"GOV": "امر عمل اعلان",
"ISSUEBADGE ID": "امر عمل شارة",
"ISSUEBADGEID": "امر عمل شارة",
"IB": "امر عمل شارة",
"BIND": "امر تسجيل زر بشيء",
"1": ".",
"PL": "قانون تفتيش الممتلكات",
"TOGFC": "تغيير شات الفاكشن",
"TOGGLEF": "فتح او غلق شات الفاكشن",
"FL": "شات ليدرات الفاكشن",
"HQ": "شات جميع اليدرات",
"F": "شات الفاكشن",
"AR": "قبول ريبورت",
"CR": "اقفل ريبورت",
"RI": "قرائة ريبورت",
"DR": "ترك ريبورت",
"FR": "حذف ريبورت",
"ADDE": "عمل سهم",
"DELE": "حذف سهم",
"DELNEARBYE": "حذف كل الاسهم الي جنبك مرة واحدة",
"NEARBYE": "معرفة ايدي السهم",
"GOTO-ID": "انتقال لشخص",
"GOTO": "انتقال لشخص",
"GETVEH": "سحب سيارة",
"FIXVEH": "تصليح سيارة",
"FUELVEH-100": "تعبئة البنزين لسيارة",
"FUELVEH": "تعبئة البنزين لسيارة",
"SETJOB-ID-5": "اعطاء رخصة ميكانيكي",
"GOTOVEH": "تنتقل لسيارة",
"AHEAL-ID": "تعبي دم",
"SENDTOVEH-ID-ID": "ترسل شخص لسيارة",
"SENDTOVEH": "ترسل شخص لسيارة",
"SENDVEH-ID-ID": "ترسل سيارة لشخص",
"SENDVEH": "ترسل سيارة لشخص",
"CHANGENAME-ID": "تغير اسم شخص",
"CHECKINT": "معلومات الانترو",
"CHECKVEH": "معلومات السيارة",
"CHECK-ID": "معلومات اللاعب",
"GMLOUNGE": "غرفة اجتماعات السبورتر و الدمنية",
"GOTOPLACE": "انتقال لمكان",
"PLACE": "جميع الاماكن",
"NUDEGE": "تنبيه الادمنية او السيبورتر",
"SDUTY": "تشغيل شارة السيبورتر",
"G": "شات السيبورتر",
"ST": "شات المساعدات",
"SHOWFEEDBACKS": "رؤية تقييماتك",
"ENTERCAR": "ركوب شخص سيارة",
"UNFLIP": "تعديل السيارة اذا كانت مقلوبة",
"RESPAWNVEH": "رسباون لسيارة",
"SHOWFACTIONS": "اظهار قائمة الفاكشنات",
"ANN": "ارسال رسالة في الشريط العلوي",
"ENTERVEH-ID-IDCAR": "تنقل شخص لسيارة و تخليه راكبها",
"ENTERVEH-ID-ID": "تنقل شخص لسيارة و تخليه راكبها",
"ENTERVEH": "تنقل شخص لسيارة و تخليه راكبها",
"FREECAM": "اختفاء",
"DI": "ارسال ريبورت لشخص",
"FREEZE": "تجميد",
"UNFREEZE": "فك تجميد",
"STAFFS": "رؤية كم ريبورت لديك",
"GETHERE": "احضار شخص اليك",
"ADD": "غرفة الدمنية",
"WD": "غرفة الدمنية",
}

async function main() {
  console.log("Cleaning old rules...")
  // Optional: clear table first if you want a fresh start
  // await prisma.rule.deleteMany({}) 

  const formattedData = Object.entries(rawRules).map(([code, text]) => ({
    title: code,
    content: text,
  }))

  console.log(`Attempting to insert ${formattedData.length} rules...`)
  
  const result = await prisma.rule.createMany({
    data: formattedData,
    skipDuplicates: true,
  })

  console.log(`Success! Inserted ${result.count} rules.`)
}

main()
  .catch(e => {
    console.error(e)
    process.exit(1)
  })
  .finally(async () => {
    await prisma.$disconnect()
  })